<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tabbed Dashboard App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 800px;
      margin: 40px auto;
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .tabs {
      display: flex;
      background: #007bff;
      border-radius: 8px 8px 0 0;
      overflow: hidden;
    }
    .tab {
      flex: 1;
      text-align: center;
      padding: 14px;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    .tab:hover {
      background: #0056b3;
    }
    .active-tab {
      background: #0056b3;
    }
    .page {
      display: none;
    }
    .page.active {
      display: block;
    }
    input, button {
      display: block;
      margin: 10px 0;
      padding: 8px;
      width: 100%;
      max-width: 400px;
    }
    table, th, td {
      border: 1px solid #ccc;
      border-collapse: collapse;
      padding: 8px;
    }
    table {
      width: 100%;
      margin-top: 10px;
    }
    #logout {
      float: right;
      margin-top: -40px;
      background: crimson;
      color: white;
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<!-- Login Section -->
<div class="container" id="login-section">
  <h2>Login</h2>
  <input type="text" id="username" placeholder="Username" />
  <input type="password" id="password" placeholder="Password" />
  <button onclick="login()">Login</button>
</div>

<!-- Main App Section -->
<div class="container hidden" id="app-section">
  <button id="logout" onclick="logout()">Logout</button>
  <h2>Welcome, <span id="user-role"></span></h2>

  <!-- Tabs -->
  <div class="tabs" id="tabs">
    <div class="tab active-tab" onclick="showPage('dashboard')">Dashboard</div>
    <div class="tab" onclick="showPage('roi')">ROI Calculator</div>
    <div class="tab" onclick="showPage('upload')">File Upload</div>
    <div class="tab hidden" id="admin-tab" onclick="showPage('admin')">Admin Panel</div>
  </div>

  <!-- Pages -->
  <div id="dashboard" class="page">
    <h3>üè† Dashboard</h3>
    <p>This is the main dashboard. Use the tabs above to explore features.</p>
  </div>

  <div id="roi" class="page">
    <h3>üìä ROI Calculator</h3>
    <input type="number" id="cost" placeholder="Cost" />
    <input type="number" id="gain" placeholder="Return" />
    <button onclick="calculateROI()">Calculate ROI</button>
    <p id="roi-result"></p>
  </div>

  <div id="upload" class="page">
    <h3>üìÅ File Upload & Analysis</h3>
    <input type="file" id="fileInput" accept=".csv" />
    <button onclick="analyzeFile()">Analyze</button>
    <div id="file-analysis"></div>
  </div>

  <!-- ADMIN PANEL START -->
  <div id="admin" class="page">
    <h3>üîê Admin Panel</h3>

    <h4>‚ûï Add New User</h4>
    <input type="text" id="new-username" placeholder="New Username" />
    <input type="password" id="new-password" placeholder="New Password" />
    <button onclick="addUser()">Add User</button>

    <h4>üîÅ Reset Password</h4>
    <input type="text" id="reset-username" placeholder="Username to Reset" />
    <input type="password" id="reset-password" placeholder="New Password" />
    <button onclick="resetPassword()">Reset Password</button>

    <h4>‚ùå Delete User</h4>
    <input type="text" id="delete-username" placeholder="Username to Delete" />
    <button onclick="deleteUser()">Delete User</button>

    <h4>üë• All Users</h4>
    <ul id="user-list"></ul>
  </div>
  <!-- ADMIN PANEL END -->
</div>

<script>
  let users = JSON.parse(localStorage.getItem('users')) || {
    admin: 'admin123',
    user: 'user123'
  };

  function saveUsers() {
    localStorage.setItem('users', JSON.stringify(users));
  }

  function login() {
    const uname = document.getElementById('username').value;
    const pwd = document.getElementById('password').value;

    if (users[uname] && users[uname] === pwd) {
      localStorage.setItem('loggedInUser', uname);
      showApp();
    } else {
      alert('Invalid credentials!');
    }
  }

  function logout() {
    localStorage.removeItem('loggedInUser');
    location.reload();
  }

  function showApp() {
    const user = localStorage.getItem('loggedInUser');
    if (!user) return;

    document.getElementById('login-section').classList.add('hidden');
    document.getElementById('app-section').classList.remove('hidden');
    document.getElementById('user-role').innerText = user;

    if (user === 'admin') {
      document.getElementById('admin-tab').classList.remove('hidden');
      renderUserList();
    }

    showPage('dashboard');
  }

  function calculateROI() {
    const cost = parseFloat(document.getElementById('cost').value);
    const gain = parseFloat(document.getElementById('gain').value);

    if (isNaN(cost) || isNaN(gain)) {
      document.getElementById('roi-result').innerText = 'Please enter valid numbers.';
      return;
    }

    const roi = ((gain - cost) / cost) * 100;
    document.getElementById('roi-result').innerText = `ROI: ${roi.toFixed(2)}%`;
  }

  function analyzeFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return alert('Please upload a CSV file.');

    const reader = new FileReader();
    reader.onload = function(e) {
      const lines = e.target.result.split('\n').filter(line => line.trim() !== '');
      const headers = lines[0].split(',');
      const numRows = lines.length - 1;

      let tableHTML = '<table><tr>';
      headers.forEach(h => tableHTML += `<th>${h}</th>`);
      tableHTML += '</tr>';

      lines.slice(1).forEach(row => {
        tableHTML += '<tr>';
        row.split(',').forEach(col => tableHTML += `<td>${col}</td>`);
        tableHTML += '</tr>';
      });
      tableHTML += '</table>';

      document.getElementById('file-analysis').innerHTML = `
        <p>Rows Analyzed: ${numRows}</p>
        ${tableHTML}
      `;
    };
    reader.readAsText(file);
  }

  function addUser() {
    const uname = document.getElementById('new-username').value;
    const pwd = document.getElementById('new-password').value;
    if (!uname || !pwd) return alert('Please fill both fields.');
    if (users[uname]) return alert('User already exists.');
    users[uname] = pwd;
    saveUsers();
    renderUserList();
    alert('User added successfully!');
  }

  function resetPassword() {
    const uname = document.getElementById('reset-username').value;
    const pwd = document.getElementById('reset-password').value;
    if (!users[uname]) return alert('User does not exist.');
    users[uname] = pwd;
    saveUsers();
    alert('Password reset!');
  }

  function deleteUser() {
    const uname = document.getElementById('delete-username').value;
    if (uname === 'admin') return alert("Can't delete admin!");
    if (!users[uname]) return alert('User not found.');
    delete users[uname];
    saveUsers();
    renderUserList();
    alert('User deleted.');
  }

  function renderUserList() {
    const ul = document.getElementById('user-list');
    ul.innerHTML = '';
    for (let user in users) {
      const li = document.createElement('li');
      li.textContent = user;
      ul.appendChild(li);
    }
  }

  function showPage(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');

    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active-tab'));
    const tabIndex = {dashboard: 0, roi: 1, upload: 2, admin: 3}[pageId];
    document.querySelectorAll('.tab')[tabIndex]?.classList.add('active-tab');
  }

  window.onload = function () {
    users = JSON.parse(localStorage.getItem('users')) || {
      admin: 'admin123',
      user: 'user123'
    };
    showApp();
  };
</script>

</body>
</html>
